#!/usr/bin/env bash

# Git
alias grbm='gfo && grb origin/master'
alias ga='git add .'
alias grbmi='gfo && grb -i origin/master'
alias gast='ga && git stash'
alias gdsg='gd --staged'
alias gdst='echo $(gd --stat) && echo $(gd --numstat)'
alias gh='github ./'
gpr() {
    local -r BRANCH="$1"
    g --no-pager diff --stat "$BRANCH"
}
gx() {
    git fetch origin
    for branch in $(git --no-pager branch | grep -v master); do
        echo "Attempting delete with -d"
        if [[ $(git branch -d "$branch" 2>/dev/null) -ne 0 ]]; then
            git ls-remote --exit-code --heads origin "$branch"
            if [[ $? -eq 2 ]]; then
                echo "Force deleting"
                git branch -D "$branch"
            fi
        fi
    done
}

# GPG
alias gpg-new='gpg --full-generate-key'
alias gpg-long='gpg --list-secret-keys --keyid-format LONG'
gpg-id() {
    gpg-long | grep -B 2 "$1" | head -n1 | cut -d/ -f2 | cut -d' ' -f1
}
# gpg-export [-secret-key] ID
gpg-export() {
    if [[ -n $2 ]]; then
        gpg "--export$1" --armor "$2" | pbcopy
    else
        gpg --export --armor "$1" | pbcopy
    fi
}
gpg-import() {
    echo -e "$(pbpaste)" | gpg --batch --passphrase "$1" --import
}
gpg-rm() {
    gpg --delete-secret-key "$1"
    gpg --delete-key "$1"
}
gpg-git() {
    gpg-id "$1" | xargs git config --global user.signingkey
}

# Misc
alias xc='open *.xcworkspace([1])'
alias h='history'
alias snip='pet search | pbcopy'
alias spd='speedtest-cli'

# Tmux
alias ta='tmux attach -t'
alias tn='tmux new-session -s'
alias tls='tmux list-sessions'
alias tk9='tmux kill-server'
alias tks='tmux kill-session -t'

# Docker
alias d=docker
alias dc=docker-compose

